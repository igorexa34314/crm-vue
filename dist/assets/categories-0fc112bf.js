import{d as M,u as U,b as L,aa as T,a as q,k as C,f as _,z as S,K as p,t as h,q as e,i as o,h as v,x as B,p as F,C as E,$ as D,m as N,Y as A,w as R,a2 as z,U as K,r as Y,g as $,ap as I,aq as j,_ as G}from"./index-0f7889a6.js";import{_ as w,c as x}from"./validations-f3cfa90b.js";import{u as H,c as J,a as O,f as P}from"./useCurrencyFilter-bfdc7509.js";import{a as Q}from"./index-3d5b041a.js";import"./auth-e8c2f44c.js";const W={class:"subtitle"},X={class:"text-h5 mb-7"},Z=M({__name:"CreateCategory",emits:["created"],setup(k,{emit:y}){const{t:l}=U({inheritLocale:!0,useScope:"global"}),{currencyFilter:n}=H(),{showMessage:m}=L(),c=Math.floor(n.value(50)),{userCurrency:u}=T(q()),d=C(),i=C({title:"",limit:c}),a=async()=>{var r,t,s;if((t=await((r=d.value)==null?void 0:r.validate()))==null?void 0:t.valid)try{const{limit:g,...V}=i.value,b=await J({...V,limit:n.value(g,void 0,"reverse")});if(b)y("created",b),(s=d.value)==null||s.reset(),i.value.limit=c,m("Категория создана");else throw new Error("category undefined")}catch{m("error_create_category")}};return(f,r)=>(_(),S("div",null,[p("div",W,[p("h4",X,h(e(l)("create")),1)]),o(e(A),{ref_key:"form",ref:d,onSubmit:N(a,["prevent"])},{default:v(()=>[o(w,{modelValue:i.value.title,"onUpdate:modelValue":r[0]||(r[0]=t=>i.value.title=t),rules:e(x).title,variant:"underlined",label:e(l)("title"),required:""},null,8,["modelValue","rules","label"]),o(w,{modelValue:i.value.limit,"onUpdate:modelValue":r[1]||(r[1]=t=>i.value.limit=t),modelModifiers:{number:!0},rules:e(x).limit,variant:"underlined",type:"number",label:e(l)("limit")+` (${e(u)})`,class:"mt-6",required:""},null,8,["modelValue","rules","label"]),o(B,{color:"green-darken-3",type:"submit",class:"mt-7"},{default:v(()=>[F(h(e(l)("create"))+" ",1),o(E,{icon:e(D),class:"ml-3"},null,8,["icon"])]),_:1})]),_:1},8,["onSubmit"])]))}}),ee={class:"subtitle"},te={class:"text-h5 mb-7"},ae=M({__name:"EditCategory",props:{categories:{}},emits:["updated"],setup(k,{emit:y}){const l=k,{t:n}=U({inheritLocale:!0,useScope:"global"}),{showMessage:m}=L(),{currencyFilter:c}=H(),{userCurrency:u}=T(q()),d=Math.floor(c.value(50)),i=C(),a=C({id:l.categories[0].id,title:"",limit:d});R(()=>a.value.id,r=>{const t=l.categories.find(({id:s})=>s===r);if(t){const{limit:s,...g}=t;a.value={...g,limit:Math.round(c.value(s))}}},{immediate:!0});const f=async()=>{var V,b;const r=(b=await((V=i.value)==null?void 0:V.validate()))==null?void 0:b.valid,{id:t,limit:s,...g}=a.value;if(r&&t)try{await O(t,{...g,limit:c.value(s,void 0,"reverse")}),m("Категория успешно обновлена"),y("updated",a.value)}catch{m("error_update_category")}};return(r,t)=>(_(),S("div",null,[p("div",ee,[p("h4",te,h(e(n)("edit")),1)]),o(e(A),{ref_key:"form",ref:i,onSubmit:N(f,["prevent"])},{default:v(()=>[o(z,{modelValue:a.value.id,"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.id=s),items:r.categories,"item-title":"title","item-value":"id",label:e(n)("select_category"),variant:"underlined"},null,8,["modelValue","items","label"]),o(w,{modelValue:a.value.title,"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.title=s),rules:e(x).title,variant:"underlined",label:e(n)("title"),class:"mt-6",required:""},null,8,["modelValue","rules","label"]),o(w,{modelValue:a.value.limit,"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.limit=s),rules:e(x).limit,variant:"underlined",type:"number",label:e(n)("limit")+` (${e(u)})`,class:"mt-6",required:""},null,8,["modelValue","rules","label"]),o(B,{color:"light-green-darken-4",type:"submit",class:"mt-7"},{default:v(()=>[F(h(e(n)("update"))+" ",1),o(E,{icon:e(D),class:"ml-3"},null,8,["icon"])]),_:1})]),_:1},8,["onSubmit"])]))}}),le={class:"title mb-7"},se={class:"text-h4 mt-4 ml-2"},oe={class:"mt-10"},ie={key:1,class:"text-h5 px-5 no-categories"},re=M({__name:"categories",setup(k){K({title:"pageTitles.categories"});const{t:y}=U({inheritLocale:!0,useScope:"global"}),{state:l,isLoading:n}=Q(P,[]),m=u=>{l.value?l.value=[...l.value,u]:l.value=[u]},c=({id:u,title:d,limit:i})=>{var a;l.value=(a=l.value)==null?void 0:a.map(f=>f.id===u?{id:u,title:d,limit:i}:f)};return(u,d)=>{const i=Y("app-loader");return _(),S("div",null,[p("div",le,[p("h3",se,h(e(y)("pageTitles.categories")),1)]),p("section",oe,[e(n)?(_(),$(i,{key:0,page:""})):(_(),$(j,{key:1,class:"px-4"},{default:v(()=>[o(I,{cols:"6",md:"6",sm:"12",class:"create-category"},{default:v(()=>[o(Z,{onCreated:m,class:"pr-6"})]),_:1}),o(I,{cols:"6",md:"6",sm:"12",class:"edit-category"},{default:v(()=>{var a;return[(a=e(l))!=null&&a.length?(_(),$(ae,{key:0,categories:e(l),onUpdated:c,class:"pl-6"},null,8,["categories"])):(_(),S("div",ie,"Категорий пока нет"))]}),_:1})]),_:1}))])])}}});const pe=G(re,[["__scopeId","data-v-f7f74e2f"]]);export{pe as default};
