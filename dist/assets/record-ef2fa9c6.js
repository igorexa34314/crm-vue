import{_ as N,M as T,u as x,g as D,h as s,c as w,i as E,r as $,a as m,y as z,G as h,t as v,b as B,n as _,e as t,d as p,U as F,W as q,X as C,Q as R,s as G,B as L,l as P,P as A,L as n}from"./index-fb57e085.js";const H={class:"title"},J={class:"text-h4 mt-4 ml-2"},O={key:1,class:"mt-10 text-center text-h6"},Q={__name:"record",setup(W){T({title:"pageTitles.newRecord"});const i=x(),g=D().appContext.app.config.globalProperties.$snackbar,f=s(),V=s(!0),y=s(!0),u=s([]),c=s(""),o=s(1),b=s(""),d=w(()=>i.state.info.info),r=s("outcome"),I=w(()=>r.value==="income"?!0:d.value.bill>=o.value),k={amount:[e=>!!e||n("message_EnterAmount"),e=>e&&e>=1||n("amount_rules")],description:[e=>!!e||n("message_EnterDescription")]};E(async()=>{u.value=await i.dispatch("category/fetchCategories"),y.value=!1,c.value=u.value[0].id});const M=async()=>{if(await f.value.validate(),I.value)try{await i.dispatch("record/createRecord",{categoryId:c.value,amount:o.value,description:b.value,type:r.value,date:new Date().toJSON()});const e=r.value==="income"?d.value.bill+o.value:d.value.bill-o.value;await i.dispatch("info/updateInfo",{bill:e}),g.showMessage(n("createRecord_success")),f.value.reset(),o.value=1}catch(e){console.error(e)}else g.showMessage(n("lack_of_amount")+` (${o.value-d.value.bill})`)};return(e,l)=>{const S=$("loader"),U=$("router-link");return m(),z("div",null,[h("div",H,[h("h3",J,v(e.$filters.localize("pageTitles.newRecord")),1)]),y.value?(m(),B(S,{key:0,class:"mt-10 page-loader"})):u.value.length?(m(),B(A,{key:2,ref_key:"form",ref:f,modelValue:V.value,"onUpdate:modelValue":l[4]||(l[4]=a=>V.value=a),onSubmit:P(M,["prevent"]),class:"record-form mt-8 px-4"},{default:p(()=>[t(F,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value=a),items:u.value,"item-title":"title","item-value":"id",label:e.$filters.localize("select_category"),variant:"underlined"},null,8,["modelValue","items","label"]),t(q,{class:"mt-3",modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=a=>r.value=a)},{default:p(()=>[t(C,{label:e.$filters.localize("income"),value:"income",density:"comfortable",color:"orange-accent-3"},null,8,["label"]),t(C,{label:e.$filters.localize("outcome"),value:"outcome",density:"comfortable",color:"orange-accent-3"},null,8,["label"])]),_:1},8,["modelValue"]),t(R,{modelValue:o.value,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value=a),modelModifiers:{number:!0},rules:k.amount,type:"number",variant:"underlined",label:e.$filters.localize("amount"),class:"mt-2",required:""},null,8,["modelValue","rules","label"]),t(R,{modelValue:b.value,"onUpdate:modelValue":l[3]||(l[3]=a=>b.value=a),rules:k.description,variant:"underlined",label:e.$filters.localize("description"),class:"mt-2",required:""},null,8,["modelValue","rules","label"]),t(G,{type:"submit",color:"light-blue-darken-4",class:"mt-7"},{default:p(()=>[_(v(e.$filters.localize("create"))+" ",1),t(L,{icon:"mdi-send",class:"ml-3"})]),_:1})]),_:1},8,["modelValue","onSubmit"])):(m(),z("div",O,[_(v(e.$filters.localize("no_categories")+". ")+" ",1),t(U,{to:"/categories"},{default:p(()=>[_(v(e.$filters.localize("create_category")),1)]),_:1})]))])}}},j=N(Q,[["__scopeId","data-v-61e97b35"]]);export{j as default};
