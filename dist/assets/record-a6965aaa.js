import{d as q,R as D,b as F,u as N,k as c,S as $,c as V,l as z,r as g,e as i,A as k,K as w,t as d,s as a,i as o,f as x,q as _,h as l,g as m,a0 as A,a1 as E,a2 as S,X as R,y as G,D as H,n as K,W as L,_ as W}from"./index-ad5f5c55.js";import{u as X}from"./category-356cd342.js";import{u as j}from"./record-b4b51f4e.js";import{r as h}from"./validations-2761c6db.js";const J={class:"title"},O={class:"text-h4 mt-4 ml-2"},P={key:1,class:"mt-10 text-center text-h6"},Q=q({__name:"record",setup(Y){D({title:"pageTitles.newRecord"});const{fetchCategories:B}=X(),{createRecord:C}=j(),{showMessage:f}=F(),v=N(),p=c(),y=c(!0),n=c([]),r=c(""),e=$({amount:1,description:"",type:"outcome"}),u=V(()=>v.info),I=V(()=>e.type==="income"?!0:u.value.bill>=e.amount);z(async()=>{n.value=await B(),y.value=!1,r.value=n.value[0].id||""});const M=async()=>{const{valid:b}=await p.value.validate();if(b&&I.value)try{await C({categoryId:r.value,amount:e.amount,description:e.description,type:e.type,date:new Date});const t=e.type==="income"?u.value.bill+e.amount:u.value.bill-e.amount;await v.updateInfo({bill:t}),f(o("createRecord_success")),p.value.reset(),e.amount=1}catch(t){console.error(t)}else f(o("lack_of_amount")+` (${e.amount-u.value.bill})`)};return(b,t)=>{const T=g("app-loader"),U=g("router-link");return i(),k("div",null,[w("div",J,[w("h3",O,d(a(o)("pageTitles.newRecord")),1)]),y.value?(i(),x(T,{key:0,class:"mt-10 page-loader"})):n.value.length?(i(),x(L,{key:2,ref_key:"form",ref:p,onSubmit:K(M,["prevent"]),class:"record-form mt-8 px-4"},{default:m(()=>[l(A,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=s=>r.value=s),items:n.value,"item-title":"title","item-value":"id",label:a(o)("select_category"),variant:"underlined"},null,8,["modelValue","items","label"]),l(E,{class:"mt-3",modelValue:e.type,"onUpdate:modelValue":t[1]||(t[1]=s=>e.type=s)},{default:m(()=>[l(S,{label:a(o)("income"),value:"income",density:"comfortable",color:"orange-accent-3"},null,8,["label"]),l(S,{label:a(o)("outcome"),value:"outcome",density:"comfortable",color:"orange-accent-3"},null,8,["label"])]),_:1},8,["modelValue"]),l(R,{modelValue:e.amount,"onUpdate:modelValue":t[2]||(t[2]=s=>e.amount=s),modelModifiers:{number:!0},rules:a(h).amount,type:"number",variant:"underlined",label:a(o)("amount"),class:"mt-2",required:""},null,8,["modelValue","rules","label"]),l(R,{modelValue:e.description,"onUpdate:modelValue":t[3]||(t[3]=s=>e.description=s),rules:a(h).description,variant:"underlined",label:a(o)("description"),class:"mt-2",required:""},null,8,["modelValue","rules","label"]),l(G,{type:"submit",color:"light-blue-darken-4",class:"mt-7"},{default:m(()=>[_(d(a(o)("create"))+" ",1),l(H,{icon:"mdi-send",class:"ml-3"})]),_:1})]),_:1},8,["onSubmit"])):(i(),k("div",P,[_(d(a(o)("no_categories")+". ")+" ",1),l(U,{to:"/categories"},{default:m(()=>[_(d(a(o)("create_category")),1)]),_:1})]))])}}});const oe=W(Q,[["__scopeId","data-v-9c7a0496"]]);export{oe as default};
