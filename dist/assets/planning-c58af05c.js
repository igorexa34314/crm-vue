import{d as B,U as L,u as F,a as I,ac as N,c as D,k,ad as w,b as M,r as S,f as c,z as m,K as i,t as n,q as e,i as y,ae as R,g as $,p as b,h as C,L as j,J as q,af as z,S as A}from"./index-906b0197.js";import{u as E,f as J}from"./useCurrencyFilter-c40ad87d.js";import{f as K}from"./record-91accc22.js";import{m as P}from"./fbMessages-e76e0baf.js";import"./auth-7a072a28.js";const U={class:"title d-flex flex-row align-center mb-3"},G={class:"text-h4 mt-4 ml-2 flex-grow-1"},H={class:"text-h4"},O={key:1,class:"mt-10 text-center text-h6"},Q={key:2,class:"mt-10 px-4"},W={class:"d-flex flex-row align-center justify-space-between mb-3"},X={class:"font-weight-bold mr-4"},Y={class:"mr-4"},ne=B({__name:"planning",async setup(Z){let o,_;L({title:"pageTitles.plan"});const{t:a,n:f}=F({inheritLocale:!0,useScope:"global"}),x=I(),{userCurrency:g}=N(x),{currencyFilter:d}=E(),T=D(()=>{var s;return((s=x.info)==null?void 0:s.bill)||1e3}),v=k(!1),h=k();try{v.value=!0;const s=([o,_]=w(()=>K()),o=await o,_(),o),p=([o,_]=w(()=>J()),o=await o,_(),o);p&&s&&(h.value=p.map(l=>{const u=s.filter(r=>r.categoryId===l.id).filter(r=>r.type==="outcome").reduce((r,V)=>r+=+V.amount,0),t=100*u/l.limit>100?100:100*u/l.limit;return{...l,percent:t,spend:u}}))}catch(s){const{showMessage:p}=M();p(P[s]||s)}finally{v.value=!1}return(s,p)=>{const l=S("app-loader"),u=S("router-link");return c(),m("div",null,[i("div",U,[i("h3",G,n(e(a)("pageTitles.plan")),1),i("h4",H,n(e(f)(e(d)(T.value),"currency",e(g))),1)]),y(R,{color:"black",thickness:"1.5",class:"bg-white mb-8"}),v.value?(c(),$(l,{key:0,class:"mt-10",page:""})):h.value&&!h.value.length?(c(),m("div",O,[b(n(e(a)("pageTitles.plan")),1),y(u,{to:"/categories"},{default:C(()=>[b(n(e(a)("no_categories")+". "),1)]),_:1})])):(c(),m("section",Q,[(c(!0),m(j,null,q(h.value,(t,r)=>(c(),m("div",{key:t.id||r,class:"mt-8"},[i("p",W,[i("strong",X,n(t.title)+":",1),i("span",Y,n(e(f)(e(d)(t.spend),"currency",e(g))+" "+e(a)("out_of")+" "+e(f)(e(d)(t.limit),"currency",e(g))),1)]),y(z,{"model-value":t.percent,id:`progress-${t.id}`,color:t.percent>=90?"red":t.percent>=60?"yellow":"green",style:{cursor:"pointer"},rounded:"","rounded-bar":""},null,8,["model-value","id","color"]),y(A,{activator:`#progress-${t.id}`,location:"bottom","content-class":t.limit-t.spend<0?"bg-deep-orange-darken-3":"bg-light-green-darken-1"},{default:C(()=>[b(n((t.limit-t.spend<0?e(a)("exceeding"):e(a)("left"))+" "+e(f)(Math.abs(e(d)(t.limit)-e(d)(t.spend)),"currency",e(g))),1)]),_:2},1032,["activator","content-class"])]))),128))]))])}}});export{ne as default};
